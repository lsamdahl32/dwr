var rtShared=function(t,e){function o(){if(!e.disabled){a(!0);var o={rt_process:"load",identifier:t,sort1:e.sort1,sort2:e.sort2,sort3:e.sort3,limit:e.limit,offset:e.offset,filter:e.filter,editCol:e.editCol,showAsList:e.showAsList,bindtypes:e.bindtypes,bindValues:e.bindValues,where:e.where};1===$("#myForm").length&&(o=i(o)),$.post(e.ajaxHandler,o,function(o){checkLoginStatus(o);var s=JSON.parse(o);if("object"==typeof s){e.countRows=Number(s.countRows);let i=$("#report_table_"+t+" .report_hdr_row").closest("tr");e.hasProfileMode&&1===e.countRows?(i.siblings().remove(),"function"==typeof window[e.refreshCallback]&&window[e.refreshCallback](e.limit,e.offset,t,e.countRows,s.rows)):(i.siblings().remove(),i.after(s.rows),a(!1),"function"==typeof window[e.refreshCallback]&&window[e.refreshCallback](e.limit,e.offset,t,e.countRows,{})),$("#double-scroll"+t).trigger("resize.doubleScroll")}else a(!1),alert(o)})}}function s(){var o={rt_process:"totPages",identifier:t,limit:e.limit,offset:e.offset,filter:e.filter,bindtypes:e.bindtypes,bindValues:e.bindValues,where:e.where};1===$("#myForm").length&&(o=i(o)),$.post(e.ajaxHandler,o,function(o){checkLoginStatus(o);var s=JSON.parse(o);"object"==typeof s?(e.totPages=s.totPages,$("#limit"+t).val(e.limit),$("#offset"+t).val(e.offset),$("#page_count_top"+t).html(" Page "+e.page+" of "+e.totPages+" "),$("#page_count_bottom"+t).html(" Page "+e.page+" of "+e.totPages+" "),$("#countRows"+t).html(s.countRows),r()):alert(o)})}function i(t){var o=!1;return $("#myForm input, #myForm select, #myForm textarea").each(function(){"SubmitRequest"===this.name&&"altSearchCriteria"===this.value&&(o=!0),o?t[this.name]=this.value:"SubmitRequest"===this.name&&"authlog"===this.value||"_in1"===this.name.substring(this.name.length-4)||"_in2"===this.name.substring(this.name.length-4)||"_so"===this.name.substring(this.name.length-3)||"subtotalBySort"===this.name?t[this.name]=this.value:"_sho"===this.name.substring(this.name.length-4)&&$(this).is(":checked")&&(t[this.name]=1),""!==e.linkField&&(t.linkField=e.linkField,t.linkID=e.linkID)}),t}function r(){0===e.totPages?($(".leftBtns"+t).attr("disabled",!0),$(".rightBtns"+t).attr("disabled",!0)):(1===e.page?$(".leftBtns"+t).attr("disabled",!0):$(".leftBtns"+t).attr("disabled",!1),e.page==e.totPages?$(".rightBtns"+t).attr("disabled",!0):$(".rightBtns"+t).attr("disabled",!1))}function l(s,r,l){e.sort1=s,e.sort2=r,e.sort3=l,$("#sort1"+t).val(e.sort1),$("#sort2"+t).val(e.sort2),$("#sort3"+t).val(e.sort3),o(),$("#report_table_"+t+" .sortArrows").remove(),$("#report_table_"+t+" .ColSort").each(function(){var o=$(this).attr("data-fieldname");-1!==e.sort1.indexOf(o)&&($("#sortBy"+t+"1").val(o),e.sort1.indexOf("DESC")>0?($("#sortDir"+t+"1").val("DESC"),$(this).append('<span class="sortArrows" style="margin-left: 8px;" title="Sorted descending"><i class="bi-caret-down" style="font-size: 1em;"></i></span>')):($("#sortDir"+t+"1").val("ASC"),$(this).append('<span class="sortArrows" style="margin-left: 8px;" title="Sorted ascending"><i class="bi-caret-up" style="font-size: 1em;"></i></span>')))});var a={rt_process:"getSort",identifier:t,sort1:e.sort1,sort2:e.sort2,sort3:e.sort3};1===$("#myForm").length&&(a=i(a)),$.post(e.ajaxHandler,a,function(e){checkLoginStatus(e);var o=JSON.parse(e);"object"==typeof o&&$("#sortFieldDisplay"+t).html("Sorted by: "+o.sort)}),console.log("Sorted and Refreshed")}function a(e){if(e){var o=$("#report_table_"+t),s=o.parent().width(),i=o.parent().height();$("#report_table_overlay_"+t).width(s).height(i)}else $("#report_table_overlay_"+t).width(0).height(0)}return $(document).ready(function(){$(".buttonBar"+t).on("click",function(){var s=$(this).attr("id").substring(0,4);return"prev"===s?(e.page--,e.page<1&&(e.page=1)):"next"===s?(e.page++,e.page>e.totPages&&(e.page=e.totPages)):"firs"===s?e.page=1:"last"===s&&(e.page=e.totPages),e.offset=(e.page-1)*e.limit,$("#offset"+t).val(e.offset),o(),$("#page_count_top"+t).html(" Page "+e.page+" of "+e.totPages+" "),$("#page_count_bottom"+t).html(" Page "+e.page+" of "+e.totPages+" "),r(),!1}),e.noColResize||e.showAsList||$("#report_table_"+t).colResizable({resizeMode:"overflow",hoverCursor:"ew-resize",dragCursor:"ew-resize",flush:e.flushColWidths,liveDrag:!0,onResize:function(o,s){$("#double-scroll"+t).trigger("resize.doubleScroll");var r=[];$("#report_table_"+t+" th").each(function(t){r.push($(this).css("width"))});var l={rt_process:"saveColWidths",identifier:t,colWidths:r,index:s};1===$("#myForm").length&&(l=i(l)),$.post(e.ajaxHandler,l,function(t){checkLoginStatus(l)})}}),$("#report_table_"+t+" .ColSort").on("click",function(){var t=$(this).attr("data-fieldname");-1!==e.sort1.indexOf(t)?e.sort1.indexOf(" ASC")>0?e.sort1=t+" DESC":e.sort1.indexOf(" DESC")>0?e.sort1=t+" ASC":e.sort1=t+" DESC":(e.sort3=e.sort2,e.sort2=e.sort1,e.sort1=t+" ASC"),l(e.sort1,e.sort2,e.sort3)}).mouseenter(function(){var o=$(this).index();$("#report_table_"+t+" .rt_col"+o).addClass(e.colClass)}).mouseleave(function(){var o=$(this).index();$("#report_table_"+t+" .rt_col"+o).removeClass(e.colClass)}),$("#report_table_"+t).on("click",".doLink",function(){var t=$(this).attr("data-fieldname"),e=$(this).attr("data-fielddata"),o=$(this).attr("data-type");$("#myForm").find("#linkField").length?($("#linkField").val(t),$("#linkID").val(e),$("#linkProcess").val(o),$("#myForm").submit()):document.location="?"+t+"="+e+"&process="+o+"&source=self"}).on("click","#cbheading",function(){$(this).is(":checked")?$(".selectCheckboxes").prop("checked",!0):$(".selectCheckboxes").prop("checked",!1)}).on("click",".expandr",function(){var t=$(this).attr("id"),e=$("."+t);e.toggle(),e.is(":visible")?$(this).html('<i class="bi-caret-up"></i>'):$(this).html('<i class="bi-caret-right"></i>')}),$("#limitSelect"+t).on("change",function(){e.limit=$(this).val(),e.page=1,e.offset=0,e.filter=$("#filterSelect"+t).val(),o(),s()}),$("#filterSelect"+t).on("change",function(){e.filter=$(this).val(),e.page=1,e.offset=0,o(),s()}),$("#report_table_"+t+" .editColumn").on("click",function(t){t.stopPropagation(),$(".editColumn").html('<i class="bi-pencil" style="font-size: 1em;"></i>').attr("title","Edit this column"),e.editCol!==this.id?(e.editCol=this.id,$("#"+this.id).html('<i class="bi-slash-circle" style="font-size: 1em;"></i>').attr("title","Cancel editing this column")):e.editCol="",o()}),$("#openCloseSortSelect"+t).on("click",function(){$(this).blur(),$("#rtSortSelect"+t).is(":visible")?$("#rtSortSelect"+t).hide(200):($("#rtSortSelect"+t).show(200),$(document).on("click.closeSort"+t,function(e){0===$(e.target).closest("#rtSortSelect"+t).length&&0===$(e.target).closest("#openCloseSortSelect"+t).length&&($("#rtSortSelect"+t).hide(200),$(document).off("click.closeSort"+t))}))}),r()}),$(document).ready(function(){$("#double-scroll"+t).doubleScroll({resetOnWindowResize:!0,onlyIfScroll:!0,timeToWaitForResize:60,contentElement:$("#report_table_"+t)}),$("#sortBtn"+t).on("click",function(){$("#rtSortSelect"+t).hide(200),$(document).off("click.closeSort"+t);let e="",o="",s="",i=$("#sortBy"+t+"1").val(),r=$("#sortDir"+t+"1").val(),a=$("#sortBy"+t+"2").val(),n=$("#sortDir"+t+"2").val(),c=$("#sortBy"+t+"3").val(),f=$("#sortDir"+t+"3").val();e=i+" "+r,""!==a&&(o=a+" "+n),""!==c&&(s=c+" "+f),l(e,o,s)}),$("#rtRestoreDefaults").on("click",function(){""!==e.linkField?doSubmitWithValues({btnRestoreDefaults:1},e.linkID,e.linkField):doSubmitWithValues({btnRestoreDefaults:1})})}),{identifier:t,settings:e,refresh:function(){o(),s(),console.log("Refreshed")},setOrderBy:function(t,e,o){l(t,e,o)},disableRefresh:function(t){e.disabled=t},setBindtypes:function(t){e.bindtypes=t},setBindValues:function(t){e.bindValues=t},setWhere:function(t){e.where=t},setLinkID:function(t){e.linkID=t},clearFilter:function(){e.filter="All",$("#filterSelect"+t+" option:first").attr("selected",!0)},setResizable:function(e){let o=$("#report_table_"+t);o.colResizable({disable:!0}),o.colResizable({resizeMode:"overflow",useLocalStorage:!0,hoverCursor:"ew-resize",dragCursor:"ew-resize",liveDrag:!0,onResize:function(t,o){$(window).trigger("resize"),"function"==typeof window[e]&&window[e](t,o)}})}}};